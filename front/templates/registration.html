{% extends 'base.html' %}

{% load i18n %}

{% block extra-head %}

	<title>MIM - Ingress Mosaics, Banners, Series</title>

	<meta property="og:url" content="https://www.myingressmosaics.com">
	<meta property="og:type" content="website">
	<meta property="og:title" content="MyIngressMosaics">
	<meta property="og:image" content="https://www.myingressmosaics.com/static/front/img/image.png">
	<meta property="og:description" content="Search, Register and Share all Ingress Mosaics">
	
{% endblock %}

{% block header %}

	{% trans 'Registration' %}
	
{% endblock %}

{% block content %}

<div id="page-container" ng-controller="RegistrationCtrl">
    
{% verbatim %}
	
	<div ng-if="!user.authenticated">
	    
	    <div class="block">
	    	
	    	<div class="row">
	    	
			    <div class="item-12 c-danger ta-center">
				    Restricted area
			    </div>
			
				<div class="item-6 ta-right">
					<a class="btn-secondary" href="/login" style="width:100px;">
						Sign in
					</a>
				</div>
			
				<div class="item-6">
					<a class="btn-secondary" href="/register" style="width:100px;">
						Sign up
					</a>
				</div>

			</div>
			
		</div>
		
	</div>
    
    <div ng-if="user.authenticated">
    
        <div class="block">
        	
	        <div class="row">
	        	
            	<div class="item-12">
            		To scan missions from Ingress Intel Map: <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo" target="blank">Tampermonkey</a> + <a href="/static/mim.scan.user.js">MIM Scanning Plugin</a>
            	</div>
            	
            	<div class="item-12">
            		To register manually missions that couldn't be scanned: <a href="https://chrome.google.com/webstore/detail/myingressmosaics-hunting/imafdiamhfamjabofbmkmbmncadhjfjk" target="_blank">MIM Hunting Tool</a>
            	</div>
            	
 	       </div>
 	       
        </div>

        <div class="block">
            
            <div class="panel">

				<div class="item-12">
					<form class="row">
					
						<div class="item grow">
							<input type="text" class="form-control" placeholder="mosaic name, creator" ng-model="searchText" />
						</div>
						
						<div class="item">
							<button id="searchButton" type="submit" style="width:100px;" class="btn btn-primary ml-2 ta-center" ng-click="search(searchText);" ng-disabled="searching">
								<span ng-show="searching">
									<i class="fa fa-spinner rotating mr-1"></i>
								</span>
								Search
							</button>
						</div>
					
					</form>
				</div>
	                
                <div class="item-12">
                    <div class="scrollbar" style="overflow:auto; height:200px; background:#0B0C0D; border:4px solid #0B0C0D;">
                    
                        <div ng-if="searchModel.results.length < 1" class="item">
                        	No mission
                        </div>
                        
	                    <div class="panel" ng-repeat="item in searchModel.results">

	                        <div class="item">
	                             <a ng-click="addMission(item);"><i class="fa fa-plus-square"></i></a>
	                         </div>
	                         
	                        <div class="item grow ellipsis">
		                        {{item.title}}
		                    </div>
		                    
                            <div class="item" ng-class="{'c-enligtened': item.faction == 'E', 'c-resistance': item.faction == 'R',}">
                                {{item.creator}}
                            </div>
                            
                            <div class="item">
                                <a href="https://www.ingress.com/mission/{{item.ref}}" target="blank">
                                    <i class="fa fa-external-link"></i>
                                </a>
                            </div>

	                     </div>
                        
                    </div>
                </div>
	                
                <div class="item-12">
                    {{searchModel.results.length}} missions
                    <span ng-if="searchModel.results.length > 0" class="text-separator">&middot;</span>
                    <a ng-if="searchModel.results.length > 0" ng-click="addAll();">Add all</a>
                </div>
                
            </div>
            
        </div>
        
        <div class="block">

            <div class="panel">

    	        <div class="item-6 item-xl-4">
    	            <label>Title</label>
    	            <input type="text" class="form-control" ng-model="mosaicModel.title" />
    	        </div>
	        
    	        <div class="item-6 item-xl-4">
    	            <label>Type</label>
    	            <select class="form-control" ng-model="mosaicModel.type">
    	                <option value="sequence">sequence</option>
    	                <option value="serie">serie</option>
    	            </select>
    	        </div>

    	        <div class="item-6 item-xl-4">
    	            <label>Columns</label>
    	            <select class="form-control" ng-model="mosaicModel.columns" />
        	                <option value="6">6</option>
        	                <option value="5">5</option>
        	                <option value="4">4</option>
        	                <option value="3">3</option>
        	                <option value="2">2</option>
        	                <option value="1">1</option>
       	            </select>
    	        </div>

    	        <div class="item-6 item-xl-4">
    	            <label>Country</label>
    	            <input type="text" class="form-control" ng-model="mosaicModel.country" />
    	        </div>

    	        <div class="item-6 item-xl-4">
    	            <label>Region</label>
    	            <input type="text" class="form-control" ng-model="mosaicModel.region" />
    	        </div>

    	        <div class="item-6 item-xl-4">
    	            <label>City</label>
    	            <input type="text" class="form-control" ng-model="mosaicModel.city" />
    	        </div>

                <div class="item-12 item-xl-6">
                	
                    <label>Preview</label>
                    
 					<div style="display:flex; height:200px; justify-content:center; background:#0b0c0d; padding:.25rem;" ng-class="{'scrollbar valign-start': mosaicModel.missions.length > 18, 'valign-center': mosaicModel.missions.length <= 18}">
					
						<div class="row" style="align-items:center; justify-content:center; padding:0 calc((6 - {{mosaicModel.columns}}) / 2 * 16.666667%); width:100%;">
				            <div ng-repeat="m in mosaicModel.missions | reverse" style="flex:0 0 calc(100% / {{mosaicModel.columns}});">
				                <img src="/static/img/mask.png" style="width:100%; background-color:#000000; background-image:url({{m.image}}=s100); background-size: 95% 95%; background-position: 50% 50%; float:left; background-repeat: no-repeat;" />
				            </div>
			            </div>
			
					</div>

                </div>
                
                <div class="item-12 item-xl-6">
                	
                    <div class="row">
                    	
                        <div class="item-12">
	                        <label>Missions</label>
		                    <div class="scrollbar" style="overflow:auto; height:200px; background:#0B0C0D; border:4px solid #0B0C0D;">
	            		        
	            		        <div ng-if="mosaicModel.missions < 1" class="item">
	            		        	No mission
	            		        </div>
	            		        
	    		                <div class="panel valign-center" ng-repeat="item in mosaicModel.missions">
	    		                	
 	    		                	<div class="item">
	    			                    <input type="text" class="form-control ta-center" ng-blur="reorder();" ng-model="item.order" style="min-width:2.5rem; width:2.5rem; min-height:1.5rem; line-height:1.5rem;" />
	    		                	</div>
	    		                	
	    		                	<div class="item grow ellipsis">
	    			                     {{item.title}}
	    		                	</div>
	    		                	
	    		                	<div class="item">
				                        <a ng-click="removeMission(item);">
				                            <i class="fa fa-minus-square"></i>
				                        </a>
	    		                    </div>
   		                    
	    		                </div>
	    		                
	                        </div>
                        </div>
                        
                        <div class="item-12">
                            {{mosaicModel.missions.length}} missions
                            <span ng-if="mosaicModel.missions.length > 0" class="text-separator">&middot;</span>
                            <a ng-if="mosaicModel.missions.length > 0" ng-click="clearAll();">Clear all</a>
                        </div>
                        
                    </div>
                    
                </div>
	        
	        	<div class="item-12 ta-center c-danger">
	        	    No update allowed after creation. Please create mosaic only when it is complete.
	        	</div>
	        	
    	        <div class="item-12 ta-center">
    	        	
    				<button class="btn-primary ta-center" style="width:100px;" ng-click="createMosaic();" ng-disabled="creating || !mosaicModel.title || !mosaicModel.type || !mosaicModel.columns || !mosaicModel.country || !mosaicModel.region || !mosaicModel.city || (mosaicModel.missions.length < 1)">
            			<span ng-show="creating">
            				<i class="fa fa-spinner"></i>
            			</span>
    				    Create
    				</button>
    
    	        </div>

	        </div>
	        
        </div>

		<div class="title">
			Potential mosaics
		</div>
		
		<div class="block">
			
			<div class="row">
			
				<div class="item-12">
					No potential
				</div>
			
				<div class="item-12 item-xl-3" ng-repeat="potential in potentials">
				
					<a class="btn-primary btn-block">
					
						<div class="row valign-center">
							
							<div class="item grow ta-left ellipsis">
					        	{{potential.name}}
					        </div>
					        
					        <div class="item c-lighter">
					        	{{potential.count}}
					        </div>
					        
						</div>
						
					</a>
		        
		        </div>
		        
			</div>

		</div>
			
		</div>
			
    </div>

</div>

{% endverbatim %}
{% endblock %}

{% block extra-script %}
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDuXb2ncs76tO-2SN8hvkE5Zt4VwtPoNcM&amp;language=en"></script>
{% endblock %}