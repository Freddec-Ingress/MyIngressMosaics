{% extends 'base.html' %}

{% load i18n %}

{% block extra-head %}

	<title>MIM - Ingress Mosaics, Banners, Series</title>

	<meta property="og:url" content="https://www.myingressmosaics.com">
	<meta property="og:type" content="website">
	<meta property="og:title" content="MyIngressMosaics">
	<meta property="og:image" content="https://www.myingressmosaics.com/static/front/img/image.png">
	<meta property="og:description" content="Search, Register and Share all Ingress Mosaics">
	
{% endblock %}

{% block header %}

	{% trans 'Registration' %}
	
{% endblock %}

{% block content %}

<div id="page-container" ng-controller="MissionsCtrl">
    
	<!-- Loading block -->
	
	<div id="block-loading" class="mt-4 px-2 py-1">
			
		<div class="loading-line px-2 py-1">
			<img src="/static/img/loading.png" />
			{% trans 'Loading data...' %}
		</div>
		
	</div>
	
{% verbatim %}

	<!-- Data block -->
	
	<div id="block-data" class="hidden">
	
        <div ng-if="!user.authenticated">
            
        	<div class="f-row pt-4 mt-4 mb-2 mx-4 text-uppercase bordered-b">
        		{{'missions_HUNTERTITLE' | translate}}
        	</div>

            <div class="card px-2">
                
                <div class="card-block first last">
                    
                    <ol>
                        <li>
                            Use our <a href="/plugin">MIM Scanning Plugin</a> to register missions from Ingress Intel Map. Unfortunetly some missions cannot be registered like that so you have to register them manually with our extension 
                            <a href="https://chrome.google.com/webstore/detail/myingressmosaics-hunting/imafdiamhfamjabofbmkmbmncadhjfjk" target="_blank">MIM Hunting Tool</a>
                        </li>
                        <li>
                            <a href="/login">Sign in</a> to MIM site
                        </li>
                        <li>
                            Got to <a href="/registration">Registration</a> page to see registered missions and create mosaics
                        </li>
                    </ol>
                    
                </div>
                
            </div>
        
        </div>
        
        <div ng-if="user.authenticated">
        
            <div class="card">
                
                <div class="card-block first last my-4">
                    <p>
                        
                        To scan missions from Ingress Intel Map:
                        
        				<a href="/plugin">
        					MIM Scanning Plugin
        				</a>
        				
                    </p>
                        <p>
                            
                            To register manually missions that couldn't be scanned:
        
                            <a href="https://chrome.google.com/webstore/detail/myingressmosaics-hunting/imafdiamhfamjabofbmkmbmncadhjfjk" target="_blank">
                                MIM Hunting Tool
                            </a>
                            
                        </p>
                </div>
                        
                <div ng-if="!mosaics.length">
                    
                    <div class="card-block first last">
                        
                        <p class="text-danger">{{'missions_NOMISSION' | translate}}</p>
                        
                        <p>
                            
                            {{'missions_UPDATENAME' | translate}}
                            
            				<a ui-sref="root.profile">
            					{{'profile_LINK' | translate}}
            				</a>
            				
                        </p>
            
                        
                    </div>
                    
                </div>
                
            	<div class="my-4" style="position:relative;" ng-repeat="mosaic in mosaics">
            		
            		<div class="f-row">
            			<span class="text-normal mr-auto">{{mosaic.missions.length}} missions</span>
            			<a href="" ng-click="deleteMosaic(mosaic);">{{'delete_LABEL' | translate}}</a>
            		</div>
            		
            		<div class="f-row">
            			<input type="text" class="form-control" ng-model="mosaic.name" />
            		</div>
            		
                    <table class="card-table card-table-compressed">
                        <tbody>
                            <tr ng-repeat="item in mosaic.missions">
        	                    <td class="text-white text-center" style="width:2rem;">
        	                    	<a ng-click="delete(mosaic, item, $index);">
        	                    		<i class="fa fa-trash"></i>
        	                    	</a>
        	                    </td>
                                <td style="width:3rem;"><input type="number" class="form-control text-center" style="padding:.25rem;" ng-model="item.order" /></td>
                                <td style="width:50%;">{{item.name}}</td>
                                <td style="width:25%;" ng-class="{'text-enligtened': item.faction == 'E', 'text-resistance': item.faction == 'R',}" ng-click="$event.stopPropagation(); toggle($index, $event, item);">{{item.creator}}</td>
                                <td class="text-right">
                                    <a href="https://www.ingress.com/mission/{{item.ref}}" class="ml-2" target="blank">
                                        <i class="fa fa-external-link"></i>
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="card-block last form-button-bar">
                		<button class="btn btn-primary" ng-click="btn_disabled = true; createMosaic(mosaic);" ng-disabled="btn_disabled">
                		    <div ng-show="!btn_disabled">{{'create_BTN' | translate}}</div>
                		    <div ng-show="btn_disabled">
                		       	<img src="/static/img/loading.png" class="rotating" width="14px" height="14px" style="margin-top:2px;" />
                		    </div>
                		</button>
                    </div>
                    
            	</div>
        	
                <div ng-if="missions.length > 0">
                    
                    <div class="card-header text-right">
                        
                        <a href="" ng-click="deleteAll();">{{'deleteall_LABEL' | translate}}</a>
                        
                    </div>
                
                    <table class="card-table no-user-select">
                        <thead>
                            <tr>
                                <th></th>
                                <th style="cursor:pointer;">
                                    <i class="fa mr-2" ng-class="{'fa-caret-up':sortName == 'asc', 'fa-caret-down':sortName == 'desc', 'fa-sort text-muted':sortName == ''}"></i>
                                    {{'missions_COLNAME' | translate}}
                                </th>
                                <th></th>
                                <th style="cursor:pointer;">
                                    <i class="fa mr-2" ng-class="{'fa-caret-up':sortCreator == 'asc', 'fa-caret-down':sortCreator == 'desc', 'fa-sort text-muted':sortCreator == ''}"></i>
                                    {{'missions_COLCREATOR' | translate}}
                                </th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="item in missions" ng-class="{'selected': isSelected(item.ref)}">
                                <td class="text-center" style="width:2rem;" ng-click="$event.stopPropagation(); toggle($index, $event, item);"><i class="fa fa-check-circle" ng-class="{'text-muted': !isSelected(item.ref)}"></i></td>
                                <td ng-click="$event.stopPropagation(); toggle($index, $event, item);">
                                    {{item.name}}
                                </td>
                                <td class="text-center">
                                    <a href="https://www.ingress.com/mission/{{item.ref}}" class="ml-2" target="blank">
                                        <i class="fa fa-external-link"></i>
                                    </a>
                                </td>
                                <td ng-class="{'text-enligtened': item.faction == 'E', 'text-resistance': item.faction == 'R',}" ng-click="$event.stopPropagation(); toggle($index, $event, item);">{{item.creator}}</td>
                                <td class="text-center" ng-click="delete(item);"><i class="fa fa-trash"></i></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="card-block last">
                        
                        <div class="form-button-bar f-justify-around">
                            
                            <div class="">
                                {{selected_missions.length}} / {{missions.length}}
                                {{'missions_selected' | translate}}
                                <br><a ng-click="unselectAll();">{{'unselectall_LABEL' | translate}}</a>
                            </div>
                            
                    		<button class="btn btn-secondary f-align-baseline" ng-click="nextStep();" ng-disabled="!hasSelected();">
                    		    {{'missions_BTN' | translate}}
                    		    <i class="fa fa-fw fa-angle-double-right btn-icon ml-2"></i>
                    		</button>
                    		
                		</div>
                        
                    </div>
                    
                 </div>
                
            </div>
           
        </div>
    
    </div>

</div>

{% endverbatim %}
{% endblock %}

{% block extra-script %}
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDuXb2ncs76tO-2SN8hvkE5Zt4VwtPoNcM&amp;language=en"></script>
{% endblock %}