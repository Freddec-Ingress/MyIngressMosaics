{% extends 'base.html' %}

{% load i18n %}

{% block extra-head %}

	<title>MIM - Admin</title>

	<meta property="og:url" content="https://www.myingressmosaics.com">
	<meta property="og:type" content="website">
	<meta property="og:title" content="MyIngressMosaics">
	<meta property="og:image" content="https://www.myingressmosaics.com/static/front/img/image.png">
	<meta property="og:description" content="Search, Register and Share all Ingress Mosaics">
	
{% endblock %}

{% block header %}

	{% trans 'Admin - Registration' %}
	
{% endblock %}

{% block content %}

<div id="page-container" ng-controller="AdmRegistrationCtrl">
    
	<div ng-show="loading_page" class="mt-4 px-2 py-1">
			
		<div class="loading-line px-2 py-1">
			<img src="/static/img/loading.png" />
			{% trans 'Loading page...' %}
		</div>
		
	</div>
    
    <div ng-show="!loading_page" class="mt-4">
        
        {{mosaics}}
        
        <div class="panel mb-4" ng-repeat="mosaic in mosaics">
            
            <div class="f-row py-1">

                <div class="">
                    <a ng-click="toggle(mosaic);">
                    	<i ng-hide="mosaic.expanded" class="mr-2 fa fa-caret-right"></i>
                    	<i ng-show="mosaic.expanded" class="mr-2 fa fa-caret-down"></i>
                    </a>
                </div>

                <div class="mr-auto">
                    {{mosaic.name}}
                    <input readonly type="text" class="form-control" style="width:25rem;" ng-model="mosaic.name" />
                </div>
                
                <div class="">
                    <input readonly type="text" class="form-control text-right" ng-model="mosaic.count" />
                </div>
                
            </div>
            
            <div ng-show="mosaic.expanded" class="pt-2" style="border-top:1px solid black;">
                
                <div class="f-row">
                
        	        <div class="group width-4 pr-1">
        	            <label class="m-0">Title</label>
        	            <input type="text" class="form-control" ng-model="mosaic.title" />
        	        </div>
        	        
        	        <div class="group width-4 px-1">
        	            <label class="m-0">Type</label>
        	            <select class="form-control" ng-model="mosaic.type">
        	                <option value="sequence">sequence</option>
        	                <option value="serie">serie</option>
        	            </select>
        	        </div>
    
        	        <div class="group width-4 pl-1">
        	            <label class="m-0">Columns</label>
        	            <select class="form-control" ng-model="mosaic.columns" />
            	                <option value="6">6</option>
            	                <option value="5">5</option>
            	                <option value="4">4</option>
            	                <option value="3">3</option>
            	                <option value="2">2</option>
            	                <option value="1">1</option>
           	            </select>
        	        </div>
        	        
                </div>
                
                <div class="f-row">
                    
        	        <div class="group width-4 pr-1">
        	            <label class="m-0">Country</label>
        	            <input type="text" class="form-control" ng-model="mosaic.country" />
        	        </div>
    
        	        <div class="group width-4 px-1">
        	            <label class="m-0">Region</label>
        	            <input type="text" class="form-control" ng-model="mosaic.region" />
        	        </div>
    
        	        <div class="group width-4 pl-1">
        	            <label class="m-0">City</label>
        	            <input type="text" class="form-control" ng-model="mosaic.city" />
        	        </div>
        	        
    	        </div>
                
                <div class="f-row">
                    
                    <div class="width-6 pr-1">
                        <label class="m-0">Preview</label>
        				<div class="bg-black f-row f-justify-center" style="height:230px; overflow-y:auto; padding-top:4px; padding-bottom:4px; padding-left:4px;" ng-class="{'f-align-start scrollbar scrollbar-mini': mosaic.missions.length > 24, 'f-align-center pr-1': mosaic.missions.length <= 24}">
        					
        					<div class="f-row f-wrap f-justify-center f-align-center" style="padding:0 calc((6 - {{mosaic.columns}}) / 2 * 16.666667%); width:100%;">
        			            <div ng-repeat="m in mosaic.missions | reverse" style="flex:0 0 calc(100% / {{mosaic.columns}});">
        			                <img src="/static/img/mask.png" style="width:100%; background-color:#000000; background-image:url({{m.image}}=s100); background-size: 95% 95%; background-position: 50% 50%; float:left; background-repeat: no-repeat;" />
        			           </div>
        					</div>
        					
        				</div>
                    </div>
                    
                    <div class="width-6 pl-1">
                        <label class="m-0">Missions</label>
                        <div class="bg-black px-1 scrollbar" style="border-top:4px solid black; border-bottom:4px solid black; flex:1; overflow:auto; height:230px;">
            		        <div ng-if="mosaic.missions < 1" class="p-2">No mission</div>
            		        <table class="card-table">
            		            <tbody>
            		                <tr ng-repeat="item in mosaic.missions">
            		                	<td class="px-1">
            			                    
            			                    <div class="f-row f-align-center">
            			                        
            			                        <div class="mr-2" style="width:2.5rem;">
            			                            <input type="text" class="form-control text-center" ng-blur="reorder();" ng-model="item.order" style="height:1.75rem;" />
            			                        </div>
            			                        
            			                        <div class="c-normal mr-auto" style="white-space:nowrap; text-overflow:ellipsis; overflow:hidden;">
            				                        {{item.title}}
            				                    </div>
            			                        
            			                        <a ng-click="removeMission(item);">
            			                            <i class="fa fa-minus-square mx-2"></i>
            			                        </a>
            			                        
            			                     </div>
            			                    
            		                    </td>
            		                </tr>
            		            </tbody>
        		           </table>
                        </div>
                        <div class="mt-2">
                            {{mosaic.missions.length}} missions
                        </div>
                    </div>
                    
    	        </div>
    	        
    	        <div class="form-button-bar mt-4">
    	        	
    				<button class="btn btn-primary" ng-click="createMosaic(mosaic);" ng-disabled="mosaic.creating || !mosaic.title || !mosaic.type || !mosaic.columns || !mosaic.country || (mosaic.missions.length < 1)">
    				    <span id="createButton">Create</span>
            			<div ng-show="mosaic.creating" class="loading-line py-1">
            				<img src="/static/img/loading.png" />
            			</div>
    				</button>

    	        </div>
                
            </div>
            
        </div>
		
	</div>
    
</div>

{% endblock %}