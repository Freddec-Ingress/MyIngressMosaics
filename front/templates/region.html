{% extends 'base.html' %}

{% load i18n %}

{% block extra-head %}

	<title>MIM - {{regionlabel}}, {{country}}</title>

	<meta property="og:url" content="https://www.myingressmosaics.com/world/{{country}}/{{region}}">
	<meta property="og:type" content="website">
	<meta property="og:title" content="MIM - {{region}}, {{country}}">
	<meta property="og:description" content="MIM - {{region}}, {{country}} - Ingress Mosaics, Banners and Mission series">
	
{% endblock %}

{% block header %}

	Region
	
{% endblock %}

{% block content %}

<div id="page-container" ng-controller="RegionCtrl" ng-init="loadRegion('{{country}}', '{{region}}');">

{% verbatim %}

	<div class="block">
		<div class="title ttrans-normal">
		<div class="row">
			<div class="item grow">
				<a href="/"><i class="fa fa-home text-separator" style="margin-left:0;"></i> Home</a>
				<span class="text-separator">></span>
				<a href="/world/{{country.name}}">
					<span ng-show="country.locale">{{country.locale}}</span><span ng-hide="country.locale">{{country.name}}</span>
				</a>
			</div>
			<div class="item">
				<a href="/map/{{region.name}},{{country.name}}">
					<i class="fa fa-map text-separator"></i>
					Map
				</a>
			</div>
		</div>
	</div>
	</div>
	
	<div class="block">
		
		<h2 class="heading">
			<span ng-show="region.locale">{{region.locale}}</span><span ng-hide="region.locale">{{region.name}}</span>
		</h2>
		
		<h3 class="subheading">
			<span ng-if="region.locale && region.locale != region.name">
				{{region.name}}
				<span class="text-separator">&middot;</span>
			</span>
			{{count|number}} Mosaics
		</h3>
		
	</div>
	
	<div class="block">
			
		<div class="title subblock">
			
			<div class="row valign-baseline">
			
				<div class="item grow">
					{{cities.length|number}} cities
				</div>
				
				<div class="item">
					<a class="badge-link badge-mini" ng-class="{'active': sort=='name'}", ng-click="sortByName();">Name</a>
				</div>

				<div class="item">
					<a class="badge-link badge-mini" ng-class="{'active': sort=='mosaics'}" ng-click="sortByMosaics();">Mosaics</a>
				</div>
				
			</div>
			
		</div>
	
		<div class="row">
			
			<div class="item-12 item-xl-3" ng-repeat="city in cities">
				
				<a href="/world/{{country.name}}/{{region.name}}/{{city.name}}" class="btn-primary btn-block" style="height:48px;">
					
					<div class="row valign-center">
						
						<div class="item grow ta-left ellipsis" style="line-height:1.25;">
							<span ng-show="city.locale">{{city.locale}}</span><span ng-hide="city.locale">{{city.name}}</span>
							<div ng-if="city.locale && city.locale != city.name">
					        	<span class="subheading ttrans-normal">{{city.name}}</span>
							</div>
				        </div>
				        
				        <div class="item">
				        	<span class="badge-dark badge-mini">{{city.mosaics}}</span>
				        </div>
				        
					</div>
					
				</a>
		        
			</div>

		</div>
		
	</div>

	<div ng-if="user.superuser">
		
		<div class="block">
			
			<div class="subblock title">
				Merge 2 cities
			</div>
			
			<div class="panel">
				
				<div class="item grow">
					<select class="form-control" ng-model="src_id">
						<option ng-repeat="city in cities" value="{{city.id}}">{{city.name}}</option>
					</select>
				</div>
				
				<div class="item grow">
					<select class="form-control" ng-model="dest_id">
						<option ng-repeat="city in cities" value="{{city.id}}">{{city.name}}</option>
					</select>
				</div>
				
				<div class="item">
					<button type="submit" class="btn btn-primary" ng-click="merge(src_id, dest_id);">
						Merge
					</button>
				</div>
				
			</div>
			
		</div>
		
		<div class="block">
			
			<div class="subblock title">
				Update cities
			</div>
			
			<div class="panel" ng-repeat="city in cities">
				
				<div class="item grow">
					<input class="form-control" ng-model="city.name">
				</div>
				
				<div class="item grow">
					<input class="form-control" ng-model="city.locale">
				</div>
				
				<div class="item">
					<button type="submit" class="btn btn-primary" ng-click="update(city);">
						Update
					</button>
				</div>
				
			</div>
			
		</div>
		
	</div>

</div>

{% endverbatim %}
{% endblock %}
